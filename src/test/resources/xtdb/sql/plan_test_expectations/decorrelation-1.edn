[:project
 [{custkey c.1/custkey}]
 [:map
  [{xt$sq_0 xt$sum_out_4}]
  [:select
   (< 1000000 xt$sum_out_4)
   [:group-by
    [c.1/custkey xt$row_number_0 {xt$sum_out_4 (sum o.2/totalprice)}]
    [:left-outer-join
     [{c.1/custkey o.2/custkey}]
     [:map
      [{xt$row_number_0 (row-number)}]
      [:rename c.1 [:scan {:table customer} [custkey]]]]
     [:rename o.2 [:scan {:table orders} [custkey totalprice]]]]]]]]
