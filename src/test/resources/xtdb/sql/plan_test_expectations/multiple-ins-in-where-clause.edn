[:project
 [{a f.1/a}]
 [:map
  [{xt$sq_1 true}]
  [:semi-join
   [(= xt$needle xt.values.3/xt$column_1)]
   [:map
    [{xt$needle f.1/b}]
    [:map
     [{xt$sq_0 true}]
     [:semi-join
      [(= xt$needle xt.values.2/xt$column_1)]
      [:map
       [{xt$needle f.1/a}]
       [:rename f.1 [:scan {:table foo} [b {a (= a 42)}]]]]
      [:rename
       xt.values.2
       [:table [xt$column_1] [{:xt$column_1 1} {:xt$column_1 2}]]]]]]
   [:rename
    xt.values.3
    [:table [xt$column_1] [{:xt$column_1 3} {:xt$column_1 4}]]]]]]
