[:top
 {:offset nil, :limit 100}
 [:project
  [{s_name s.1/s_name} numwait]
  [:order-by
   [[numwait {:direction :desc, :null-ordering :nulls-first}]
    [s.1/s_name {:direction :asc, :null-ordering :nulls-last}]]
   [:project
    [s.1/s_name {numwait xt$row_count_11}]
    [:group-by
     [s.1/s_name {xt$row_count_11 (row-count)}]
     [:map
      [{xt$sq_1 true}]
      [:map
       [{xt$sq_0 true}]
       [:mega-join
        [{s.1/s_nationkey n.4/n_nationkey}
         {l1.2/l_orderkey o.3/o_orderkey}
         {s.1/s_suppkey l1.2/l_suppkey}]
        [[:rename
          n.4
          [:scan
           {:table nation}
           [n_nationkey {n_name (= n_name "SAUDI ARABIA")}]]]
         [:rename
          o.3
          [:scan
           {:table orders}
           [{o_orderstatus (= o_orderstatus "F")} o_orderkey]]]
         [:rename
          s.1
          [:scan {:table supplier} [s_name s_nationkey s_suppkey]]]
         [:anti-join
          [(<> l_suppkey l1.2/l_suppkey) {l1.2/l_orderkey l_orderkey}]
          [:semi-join
           [(<> l_suppkey l1.2/l_suppkey) {l1.2/l_orderkey l_orderkey}]
           [:rename
            l1.2
            [:select
             (> l_receiptdate l_commitdate)
             [:scan
              {:table lineitem}
              [l_receiptdate l_suppkey l_orderkey l_commitdate]]]]
           [:project
            [{l_comment l2.5/l_comment}
             {l_commitdate l2.5/l_commitdate}
             {l_discount l2.5/l_discount}
             {l_extendedprice l2.5/l_extendedprice}
             {l_linenumber l2.5/l_linenumber}
             {l_linestatus l2.5/l_linestatus}
             {l_orderkey l2.5/l_orderkey}
             {l_partkey l2.5/l_partkey}
             {l_quantity l2.5/l_quantity}
             {l_receiptdate l2.5/l_receiptdate}
             {l_returnflag l2.5/l_returnflag}
             {l_shipdate l2.5/l_shipdate}
             {l_shipinstruct l2.5/l_shipinstruct}
             {l_shipmode l2.5/l_shipmode}
             {l_suppkey l2.5/l_suppkey}
             {l_tax l2.5/l_tax}]
            [:rename
             l2.5
             [:scan
              {:table lineitem}
              [l_partkey
               l_shipinstruct
               l_receiptdate
               l_discount
               l_orderkey
               l_returnflag
               l_commitdate
               l_extendedprice
               l_linenumber
               l_shipdate
               l_quantity
               l_comment
               l_suppkey
               l_shipmode
               l_linestatus
               l_tax]]]]]
          [:project
           [{l_comment l3.8/l_comment}
            {l_commitdate l3.8/l_commitdate}
            {l_discount l3.8/l_discount}
            {l_extendedprice l3.8/l_extendedprice}
            {l_linenumber l3.8/l_linenumber}
            {l_linestatus l3.8/l_linestatus}
            {l_orderkey l3.8/l_orderkey}
            {l_partkey l3.8/l_partkey}
            {l_quantity l3.8/l_quantity}
            {l_receiptdate l3.8/l_receiptdate}
            {l_returnflag l3.8/l_returnflag}
            {l_shipdate l3.8/l_shipdate}
            {l_shipinstruct l3.8/l_shipinstruct}
            {l_shipmode l3.8/l_shipmode}
            {l_suppkey l3.8/l_suppkey}
            {l_tax l3.8/l_tax}]
           [:rename
            l3.8
            [:select
             (> l_receiptdate l_commitdate)
             [:scan
              {:table lineitem}
              [l_partkey
               l_shipinstruct
               l_discount
               l_receiptdate
               l_orderkey
               l_returnflag
               l_commitdate
               l_extendedprice
               l_linenumber
               l_shipdate
               l_quantity
               l_comment
               l_suppkey
               l_shipmode
               l_linestatus
               l_tax]]]]]]]]]]]]]]]
