[:project
 [{o_orderpriority o.1/o_orderpriority} order_count]
 [:order-by
  [[o.1/o_orderpriority {:direction :asc, :null-ordering :nulls-last}]]
  [:project
   [o.1/o_orderpriority {order_count xt$row_count_4}]
   [:group-by
    [o.1/o_orderpriority {xt$row_count_4 (row-count)}]
    [:map
     [{xt$sq_0 true}]
     [:semi-join
      [{o.1/o_orderkey l_orderkey}]
      [:rename
       o.1
       [:scan
        {:table orders}
        [{o_orderdate
          (and
           (<
            o_orderdate
            (+
             #time/date "1993-07-01"
             (single-field-interval "3" "MONTH" 2 6)))
           (>= o_orderdate #time/date "1993-07-01"))}
         o_orderkey
         o_orderpriority]]]
      [:project
       [{l_comment l.2/l_comment}
        {l_commitdate l.2/l_commitdate}
        {l_discount l.2/l_discount}
        {l_extendedprice l.2/l_extendedprice}
        {l_linenumber l.2/l_linenumber}
        {l_linestatus l.2/l_linestatus}
        {l_orderkey l.2/l_orderkey}
        {l_partkey l.2/l_partkey}
        {l_quantity l.2/l_quantity}
        {l_receiptdate l.2/l_receiptdate}
        {l_returnflag l.2/l_returnflag}
        {l_shipdate l.2/l_shipdate}
        {l_shipinstruct l.2/l_shipinstruct}
        {l_shipmode l.2/l_shipmode}
        {l_suppkey l.2/l_suppkey}
        {l_tax l.2/l_tax}]
       [:rename
        l.2
        [:select
         (< l_commitdate l_receiptdate)
         [:scan
          {:table lineitem}
          [l_partkey
           l_shipinstruct
           l_discount
           l_receiptdate
           l_orderkey
           l_returnflag
           l_commitdate
           l_extendedprice
           l_linenumber
           l_shipdate
           l_quantity
           l_comment
           l_suppkey
           l_shipmode
           l_linestatus
           l_tax]]]]]]]]]]]
