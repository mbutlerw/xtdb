[:project
 [{avg_yearly (/ xt$sum_out_6 7.0)}]
 [:group-by
  [{xt$sum_out_6 (sum l.1/l_extendedprice)}]
  [:select
   (< l.1/l_quantity xt$sq_0)
   [:map
    [{xt$sq_0 (* 0.2 xt$avg_out_5)}]
    [:group-by
     [l.1/l_partkey
      l.1/l_quantity
      l.1/l_extendedprice
      p.2/p_partkey
      p.2/p_brand
      p.2/p_container
      xt$row_number_0
      {xt$avg_out_5 (avg l.3/l_quantity)}]
     [:left-outer-join
      [{p.2/p_partkey l.3/l_partkey}]
      [:map
       [{xt$row_number_0 (row-number)}]
       [:mega-join
        [{l.1/l_partkey p.2/p_partkey}]
        [[:rename
          l.1
          [:scan
           {:table lineitem}
           [l_partkey l_quantity l_extendedprice]]]
         [:rename
          p.2
          [:scan
           {:table part}
           [p_partkey
            {p_brand (= p_brand "Brand#23")}
            {p_container (= p_container "MED BOX")}]]]]]]
      [:rename
       l.3
       [:scan {:table lineitem} [l_partkey l_quantity]]]]]]]]]
