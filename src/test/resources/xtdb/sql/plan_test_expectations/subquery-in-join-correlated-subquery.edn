[:project
 [{a foo.1/a}]
 [:mega-join
  []
  [[:rename foo.1 [:scan {:table foo} [a]]]
   [:select
    xt$sq_0
    [:apply
     {:mark-join {xt$sq_0 (= ?xt$needle b)}}
     {bar.2/b ?xt$sq_b_3, xt$needle ?xt$needle}
     [:map
      [{xt$needle bar.2/c}]
      [:rename bar.2 [:scan {:table bar} [b c]]]]
     [:project
      [{b foo.3/b}]
      [:rename
       foo.3
       [:scan {:table foo} [b {a (= a ?xt$sq_b_3)}]]]]]]]]]
